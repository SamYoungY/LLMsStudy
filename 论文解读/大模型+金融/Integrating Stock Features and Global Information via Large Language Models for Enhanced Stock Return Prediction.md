# Integrating Stock Features and Global Information via Large Language Models for Enhanced Stock Return Prediction

论文地址：https://arxiv.org/abs/2310.05627



## 论文大概

作者提出的框架主要是两点，一是Local-Global (LG) 模型，引入了三种不同的全局信息建模策略。这些方法分别基于股票特征、LLM 的能力和结合这两种范式的混合方法，二是SCRL专注于对齐 LLM 生成的财经新闻的嵌入与同一语义空间中的股票特征。



## 论文提出的问题

作者认为先阶段基于llm在金融领域的研究，它们仅依赖于llm生成的情感信息或固有的推理能力，并没有深入研究llm中的其他有价值的知识。财经新闻可以分为三个层次，即宏观（例如市场、政策、经济）、中观（例如行业）和微观（例如股票、公司），每个层面提供不同的视角。这些不同级别的姿势难以直接将它们的信息对齐和映射到相同的级别，这在利用 LLM 来整合对股票收益预测的全面理解时提出了挑战。另一种解决方案是通过 LLM 提取新闻嵌入并将它们与股票特征连接起来。然而，LLM 和股票特征生成的嵌入本质上并不共享相同的模态，并且在统一的语义空间中不对齐。



## 论文解决办法

作者解决办法，首先，考虑库存量价格特征中固有的特殊回报。其次，检查了影响股票收益的特征，这反映在与市场相关的新闻、宏观经济政策、行业趋势和特定股票中。分离这些组件可以让我们更细致地了解有助于股票绩效的特征。此外，为了提高股票收益预测的准确性，将 LLM 生成的股票特征和新闻嵌入的信息对齐在同一语义空间中。这是通过引入自相关强化学习 (SCRL) 来实现的。

### 局部全局模型

作者提出局部全局模型，有三种情况

1. 仅使用股票特征的全局模型。就是把股票是开高收低数据，做注意力机制。全局和局部模型都只使用了股票特征。在这种情况下，全局信息可以被认为是股票特征的变换或压缩。



2. 仅使用LLM的全局模型。作者认为类似“今天，公司的股份被大量购买，导致股价上涨 6%”，这种股票价格的描述已经与特征集中的现有特征重叠。因此，作者尝试将市场、行业和政府政策的新闻作为 LLM 中的提示纳入 LLM 以获得嵌入，然后用于构建全局信息。例如“商务部部部：加强商业环境保护”与特定股票特征没有直接关系。预计合并这些信息将捕获可能影响单个股票绩效的更广泛的市场趋势、行业发展和监管变化。这种将全局信息集成到模型中允许更全面的分析，潜在地揭示隐藏模式并提高预测的准确性。LLM在预测给定附加每日新闻作为输入



3. 具有股票特征和LLM的全局模型。就是把上面两种结合起来。



### Self-Correlation强化学习

![image-20240121134651462](https://raw.githubusercontent.com/XingYu-Zhong/LLMsStudy/master/%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/pic/scrl01.png)



作者为了有效地提取新闻的嵌入，我们使用精选的新闻语料库预训练 LLM，提供了优于传统手工特征提取方法的丰富表示。做了微调！

作者使用具有库存特征集 M 的监督学习方法训练 Local-Global 模型（Critic 模型）。接下来，我们使用经过训练的 Critic 模型初始化 Actor 模型并微调 Actor 模型。这种训练模式允许模型学习更复杂的决策边界，从而提高预测性能。



## 实验

实验数据实验在中国 A股市场上进行，该数据集包含 3506 个股票和 342 个从 01/01/2019 到 12/31/2022 的股票价格-体积数据构建的每日特征。

作者根据预测回报对股票进行每日排序，并将它们分成十个分位数。策略涉及从前 10% 分位数购买平等分配股票，同时清算不属于该分位数的投资组合。所有交易都以关闭价格执行，交易成本为 0.3%。此外，将重点限制在 3:30 PM 之前交易日结束和 9:30 AM 当前交易日开始之间发布的新闻。

奇怪的是作者微调llama7b的模型用了八张A100，可能是训练数据多，加快训练速度。

![image-20240121223721979](https://raw.githubusercontent.com/XingYu-Zhong/LLMsStudy/master/%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/pic/scrl02.png)

对标实验方式文章：https://arxiv.org/pdf/2304.07619.pdf



## 总结

文章实验具体过程没有明确说明，但是数据还是非常好的，但没有代码，表述模糊，复现可能性较小，且文章在交易上没有说明，但是我读下来，感觉是通过ppo算法做交易的，可能是action就是选股，然后买入。